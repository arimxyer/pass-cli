{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "$id": "https://github.com/arimxyer/pass-cli/schemas/vault-metadata.json",
  "title": "Vault Metadata",
  "description": "Plaintext configuration file containing audit settings for a pass-cli vault, enabling audit logging without vault decryption.",
  "type": "object",
  "required": ["vault_id", "audit_enabled", "created_at", "version"],
  "properties": {
    "vault_id": {
      "type": "string",
      "description": "Absolute path to the vault.enc file",
      "minLength": 1,
      "pattern": "^/|^[A-Za-z]:\\\\",
      "examples": [
        "/home/user/.pass-cli/vault.enc",
        "C:\\Users\\user\\.pass-cli\\vault.enc",
        "/Users/user/.pass-cli/vault.enc"
      ]
    },
    "audit_enabled": {
      "type": "boolean",
      "description": "Whether audit logging is enabled for this vault"
    },
    "audit_log_path": {
      "type": "string",
      "description": "Absolute path to the audit.log file (required if audit_enabled is true)",
      "minLength": 1,
      "pattern": "^/|^[A-Za-z]:\\\\",
      "examples": [
        "/home/user/.pass-cli/audit.log",
        "C:\\Users\\user\\.pass-cli\\audit.log",
        "/Users/user/.pass-cli/audit.log"
      ]
    },
    "created_at": {
      "type": "string",
      "format": "date-time",
      "description": "Timestamp when metadata file was first created (ISO 8601 / RFC3339 format)",
      "examples": [
        "2025-10-20T10:15:30Z",
        "2025-10-20T10:15:30.123456Z",
        "2025-10-20T10:15:30-04:00"
      ]
    },
    "version": {
      "type": "integer",
      "description": "Metadata file format version (currently 1)",
      "minimum": 1,
      "default": 1,
      "examples": [1]
    }
  },
  "if": {
    "properties": {
      "audit_enabled": { "const": true }
    }
  },
  "then": {
    "required": ["audit_log_path"],
    "properties": {
      "audit_log_path": {
        "minLength": 1
      }
    }
  },
  "examples": [
    {
      "vault_id": "/home/user/.pass-cli/vault.enc",
      "audit_enabled": true,
      "audit_log_path": "/home/user/.pass-cli/audit.log",
      "created_at": "2025-10-20T10:15:30Z",
      "version": 1
    },
    {
      "vault_id": "C:\\Users\\user\\.pass-cli\\vault.enc",
      "audit_enabled": false,
      "audit_log_path": "",
      "created_at": "2025-10-20T14:30:00-04:00",
      "version": 1
    },
    {
      "vault_id": "/Users/user/.pass-cli/vault.enc",
      "audit_enabled": true,
      "audit_log_path": "/Users/user/.pass-cli/audit.log",
      "created_at": "2025-10-20T10:15:30.123456Z",
      "version": 1
    }
  ],
  "additionalProperties": false
}
